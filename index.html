<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Job V1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/fontawesome-all.css">
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- Color switcher Alternatives | you can remove this section -->
    <link rel="stylesheet" type="text/css" href="assets/css/colors/switch.css">
    <link href="assets/css/colors/color-2.css" rel="alternate stylesheet" type="text/css" title="color-2">
    <link href="assets/css/colors/color-3.css" rel="alternate stylesheet" type="text/css" title="color-3">
    <link href="assets/css/colors/color-4.css" rel="alternate stylesheet" type="text/css" title="color-4">
    <link href="assets/css/colors/color-5.css" rel="alternate stylesheet" type="text/css" title="color-5">

<body>
    <style>
        #loader {
            border: 12px solid #f3f3f3;
            border-radius: 50%;
            border-top: 12px solid #444444;
            width: 70px;
            height: 70px;
            animation: spin 1s linear infinite;
            visibility: hidden;
        }

        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }

        .center {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
        }
    </style>


    <div class="wrapper">
        <img class="img-fluid" src="assets/img/postaicreator.png">
        <br><br>
        <div class="wizard-content-1 pos-flex clearfix">
            <div class="steps d-inline-block clearfix">
                <span class="bg-shape"></span>
                <ul class="tablist multisteps-form__progress">
                    <li class="multisteps-form__progress-btn js-active current">
                        <div class="step-btn-icon-text">
                            <span>1</span>
                            <div class="step-btn-icon float-left position-relative">
                                <img src="assets/img/bt1.png" alt="">
                            </div>
                            <div class="step-btn-text">
                                <h2 class="text-uppercase">Bienvenue</h2>
                                <span class="text-capitalize">PostAICreator</span>
                            </div>
                        </div>
                    </li>
                    <li class="multisteps-form__progress-btn">
                        <div class="step-btn-icon-text">
                            <span>2</span>
                            <div class="step-btn-icon float-left position-relative">
                                <img class="fix-image" src="assets/img/bt2.png" alt="">
                            </div>
                            <div class="step-btn-text">
                                <h2 class="text-uppercase">Création</h2>
                                <span class="text-capitalize">De votre contenu</span>
                            </div>
                        </div>
                    </li>
                    <li class="multisteps-form__progress-btn">
                        <div class="step-btn-icon-text">
                            <span>3</span>
                            <div class="step-btn-icon float-left position-relative">
                                <img class="fix-image-2" src="assets/img/bt3.png" alt="">
                            </div>
                            <div class="step-btn-text">
                                <h2 class="text-uppercase">Merci</h2>
                                <span class="text-capitalize">Validation</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="step-inner-content clearfix position-relative">
                <span class="bg-shape"></span>
                <form class="multisteps-form__form" action="" id="wizard">
                    <div class="form-area position-relative">
                        <div class="multisteps-form__panel js-active" data-animation="scaleIn">
                            <div class="wizard-forms position-relative">
                                <span class="step-no position-absolute">Étape 1</span>
                                <div class="wizard-progress">
                                    <span>1 sur 3 Complété</span>
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 33%;">
                                        </div>
                                    </div>
                                </div>
                                <div class="wizard-inner-box">
                                    <div class="inner-title text-center">
                                        <h2>Choisissez votre type de contenu</h2>
                                        <p>L'intelligence artificielle au service des réseaux sociaux </p>
                                    </div>
                                    <div id="need-job-slide-id" class="need-job-slide owl-carousel">
                                        <label class="need-job-icon-text text-center">
                                            <input type="radio" name="job_title" value="Ux designer label"
                                                class="j-checkbox" checked>
                                            <span class="need-job-text-inner">
                                                <span class="checkbox-circle-mark position-absolute"> </span>
                                                <span class="need-job-icon">
                                                    <img src="assets/img/bt1.png" alt="">
                                                </span>
                                                <span class="need-job-text">
                                                    <span class="text-uppercase need-job-title">Facebook</span>
                                                    <span class="text-capitalize need-job-text">Post</span>
                                                </span>
                                            </span>
                                        </label>
                                        <label class="need-job-icon-text text-center">
                                            <input type="radio" name="job_title" value="Front Developer"
                                                class="j-checkbox">
                                            <span class="need-job-text-inner">
                                                <span class="checkbox-circle-mark position-absolute"> </span>
                                                <span class="need-job-icon">
                                                    <img src="assets/img/bt2.png" alt="">
                                                </span>
                                                <span class="need-job-text">
                                                    <span class="text-uppercase need-job-title">Instagram</span>
                                                    <span class="text-capitalize need-job-text">Post</span>
                                                </span>
                                            </span>
                                        </label>

                                        <label class="need-job-icon-text text-center">
                                            <input type="radio" name="job_title" value="Ux designer" class="j-checkbox">
                                            <span class="need-job-text-inner">
                                                <span class="checkbox-circle-mark position-absolute"> </span>
                                                <span class="need-job-icon">
                                                    <img src="assets/img/nd1.png" alt="">
                                                </span>
                                                <span class="need-job-text">
                                                    <span class="text-uppercase need-job-title">Facebook</span>
                                                    <span class="text-capitalize need-job-text">Story</span>
                                                </span>
                                            </span>
                                        </label>
                                        <label class="need-job-icon-text text-center">
                                            <input type="radio" name="job_title" value="Ux designer" class="j-checkbox">
                                            <span class="need-job-text-inner">
                                                <span class="checkbox-circle-mark position-absolute"> </span>
                                                <span class="need-job-icon">
                                                    <img src="assets/img/nd1.png" alt="">
                                                </span>
                                                <span class="need-job-text">
                                                    <span class="text-uppercase need-job-title">Instagram</span>
                                                    <span class="text-capitalize need-job-text">Story</span>
                                                </span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                                <div class="actions">
                                    <ul>
                                        <li><span class="js-btn-next" title="NEXT">SUIVANT</span></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bottom-vector position-absolute">
                                <img src="assets/img/sd1.png" alt="">
                            </div>
                        </div>
                        <!-- step 1 -->
                        <div class="multisteps-form__panel" data-animation="scaleIn">
                            <div class="wizard-forms form-step-2">
                                <span class="step-no position-absolute">Étape 2</span>
                                <div class="wizard-progress">
                                    <span>2 sur 3 Complété</span>
                                    <div class="progress">
                                        <div class="progress-bar" style="width: 66%;">
                                        </div>
                                    </div>
                                </div>
                                <div class="wizard-inner-box">
                                    <div class="inner-title text-center">
                                        <h2>Génération du contenu ? </h2>
                                        <p>Soyez le plus précis possible dans vos requêtes</p>
                                    </div>
                                </div>
                                <div class="details-form-area">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-input-inner position-relative has-float-label">
                                                <input type="text" name="first_name"
                                                    placeholder="Idée générale du post " class="form-control"
                                                    id="question" required>
                                                <label>Idée générale du post</label>
                                                <div class="icon-bg text-center">
                                                    <i class="fas fa-bullhorn"></i>
                                                </div>


                                            </div>


                                            <div class="form-input-inner position-relative has-float-label">
                                                <input type="text" name="first_name"
                                                    placeholder="Décrivez précisément avec le plus de détails possible l'image souhaitée "
                                                    class="form-control" id="image-question" required>
                                                <label>Image souhaitée </label>
                                                <div class="icon-bg text-center">
                                                    <i class="fas fa-image"></i>
                                                </div>

                                            </div>

                                        </div>

                                        <div class="col-lg-8">

                                        </div>

                                    </div>


                                </div>
                            </div>
                            <div class="actions">
                                <ul>
                                    <li><span class="js-btn-prev" title="BACK">RETOUR</span></li>
                                    <!-- <li>
										<button class="btn btn-primary" type="button" name="generate-image" onclick="text();image()">Générer</button>
									</li> -->
                                    <li>
                                        <button type="button" onclick="text();image()"><span class="js-btn-next"
                                                title="NEXT">VALIDER </span></button>
                                    </li>
                                </ul>
                            </div>
                            <div class="bottom-vector position-absolute">
                                <img src="assets/img/sd1.png" alt="">
                            </div>
                        </div>
                    </div>
                    <!-- step 2 -->
                    <div class="multisteps-form__panel" data-animation="scaleIn">
                        <div id="loader" class="center"></div>
                        <div class="wizard-forms form-step-3">
                            <span class="step-no position-absolute">Étape 3</span>
                            <div class="wizard-progress">
                                <span>3 sur 3 Complété</span>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 100%;">
                                    </div>
                                </div>
                            </div>
                            <div class="wizard-inner-box">
                                <div class="thank-content text-center">
                                    <div class="">
                                        <div class="col-lg-12">
                                            <textarea placeholder="" id="output" style="width:100%"
                                                rows="10"></textarea>
                                        </div>
                                    </div>


                                    <div class="input-filed-innerbox">
                                        <div class="row">

                                        </div>
                                        <div class="col-lg-12">
                                            <img src="" id="myImg">
                                        </div>
                                    </div>

                                    <div class="thank-text">
                                        <h2>Votre post est prêt !</h2>
                                        <p><span>Merci</span> d'utiliser PostAICreator </br></br> MADE WITH ❤️ IN LA
                                            RÉUNION BY CHRISTOPHER NEMBLY</p>
                                    </div>
                                    <div class="thank-subscribe position-relative">

                                    </div>
                                    <div style="display: flex;gap: 1rem;">
                                        <a class="thank-btn text-uppercase" href="index.html">Accueil</a>

                                        <!-- </div>
                                    <div class="thank-btn text-uppercase"> -->
                                        <button class="thank-btn text-uppercase" style="border: none;"
                                            id="img-button">Download</button>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- step 3 -->
            </div>
            </form>
        </div>
    </div>
    </div>

    <script src="assets/js/jquery-3.3.1.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="assets/js/form-step.js"></script>
    <script src="assets/js/jquery.validate.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/switch.js"></script>
    <script>
        $("#customFile").change(function () {
            filename = this.files[0].name
        });
        $(".custom-file-input").on("change", function () {
            var fileName = $(this).val().split("\\").pop();
            $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
        });
        $('.datepicker').datepicker({
            clearBtn: true,
            format: "dd/mm/yyyy"
        });
    </script>
    <script>

        var key = '';
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "key.txt", true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                key = xhr.responseText;
            }
        };
        xhr.send();


        function text() {
            // console.log("hello")
            var url = "https://api.openai.com/v1/completions";

            var xhr = new XMLHttpRequest();
            xhr.open("POST", url);

            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader(
                "Authorization",
                `Bearer ${key}`
            );

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    console.log(xhr.status);
                    console.log(xhr.responseText);
                    let response = xhr.responseText;
                    response = JSON.parse(response);

                    console.log(response);

                    document.getElementById("output").innerHTML =
                        response["choices"][0]["text"];
                }
            };

            var question = document.getElementById("question").value;
            prompt = "Create facebook post of 200 words for title: " + question + "with emoji and no picture in french language"


            prompt = JSON.parse(JSON.stringify(prompt));


            var data = {
                model: "text-davinci-003",
                prompt: prompt,
                temperature: 0.7,
                max_tokens: 2048,
                top_p: 1,
                frequency_penalty: 0,
                presence_penalty: 0,
            };

            data = JSON.stringify(data);

            xhr.send(data);
        }




        function image() {
            // console.log("hello")
            var url = "https://api.openai.com/v1/images/generations";

            var xhr = new XMLHttpRequest();
            xhr.open("POST", url);

            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader(
                "Authorization",
                `Bearer ${key}`
            );

            // var imgo;
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    document.querySelector(
                        "#loader").style.visibility = "hidden";
                    console.log(xhr.status);
                    console.log(xhr.responseText);
                    let response = xhr.responseText;
                    response = JSON.parse(response);

                    let imgOutput = response["data"][0]["url"];



                    document.getElementById("myImg").src = imgOutput
                }
            };



            var question = document.getElementById("image-question").value;
            prompt = "Below text is in french language:" + question



            prompt = JSON.parse(JSON.stringify(question));


            var data = {
                // model: "text-davinci-003",
                prompt: prompt,
                n: 1,
                size: "1024x1024"
                // temperature: 0.7,
                // max_tokens: 2048,
                // top_p: 1,
                // frequency_penalty: 0,
                // presence_penalty: 0,
            };

            data = JSON.stringify(data);

            xhr.send(data);
            document.querySelector(
                "#loader").style.visibility = "visible";
        }

        let btnDownload = document.getElementById('img-button');
        let img = document.getElementById('myImg');


        // Must use FileSaver.js 2.0.2 because 2.0.3 has issues.
        btnDownload.addEventListener('click', () => {
            let imagePath = img.getAttribute('src');
            // let fileName = getFileName(imagePath);
            saveAs(imagePath, "output.png");
        });
    </script>
       <script src="assets/js/FileSaver.min.js"></script>
</body>

</html>